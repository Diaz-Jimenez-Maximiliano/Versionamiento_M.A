import tkinter as tk
from tkinter import ttk, messagebox
from PIL import ImageTk, Image

# ---------------- Estado de sesión ---------------- #
sesion = {
    "usuario": None,
    "contraseña": None
}
# ---------------- Login ---------------- #
def login(inicio):
    iniciar_sesion = tk.Toplevel()
    iniciar_sesion.title("Iniciar sesión")
    iniciar_sesion.geometry("400x300")

    tk.Label(iniciar_sesion, text="Usuario").pack(pady=10)
    us = tk.Entry(iniciar_sesion, width=20)
    us.pack(pady=5)

    tk.Label(iniciar_sesion, text="Contraseña").pack(pady=10)
    c = tk.Entry(iniciar_sesion, width=20, show="*")
    c.pack(padx=5)

    def iniciar():
        usuario = us.get()
        contraseña = c.get()
        if usuario == "hector" and contraseña == "2008":
            sesion["usuario"] = usuario
            sesion["contraseña"] = contraseña
            iniciar_sesion.destroy()
            Arbir_jefe(inicio)
        elif usuario == "cbtisfs1001" and contraseña == "010909":
            sesion["usuario"] = usuario
            sesion["contraseña"] = contraseña
            iniciar_sesion.destroy()
            Abrir_Proovedor(inicio)
        elif usuario=="nataly" and contraseña=="2009":
            sesion["usuario"] = usuario
            sesion["contraseña"] = contraseña
            messagebox.showinfo("Empleada", f"Hola {usuario}")
        elif usuario=="ibrahim" and contraseña=="2009":
            sesion["usuario"] = usuario
            sesion["contraseña"] = contraseña
            messagebox.showinfo("Usuario Final", f"Hola {usuario}")
        else:
            #messagebox.showerror("Error", "Usuario o contraseña incorrecta")
            tk.Label(iniciar_sesion,text="Error.\nUsuario o contraseña incorrecto").pack(pady=10)
            us.delete(0, tk.END)
            c.delete(0, tk.END)

    tk.Button(iniciar_sesion, text="Continuar", font=("Times New Roman", 14), command=iniciar).pack(pady=10)
    tk.Button(iniciar_sesion, text="Cancelar", font=("Times New Roman", 14),
              command=lambda: regresar_inicio(inicio, iniciar_sesion)).pack(padx=10)

    tk.Label(iniciar_sesion, text="© Derechos Reservados - Guitarras Puebla",
             bg="#dac9ad", font=("Arial", 10), fg="black").pack(side="bottom", fill="x")

def regresar_inicio(inicio, ventana):
    ventana.destroy()
    inicio.deiconify()

# ---------------- Contactos ---------------- #
def contactos(inicio):
    ventana_contacto=tk.Toplevel()
    ventana_contacto.title("Contactos")
    ventana_contacto.geometry("500x500")
    tk.Label(ventana_contacto,text="Nombre: Maximiliano Diaz Jiménez\nNumero: 2224242958\nCorreo: cbtisfs1001@gmail.com").pack(pady=10)

# ---------------- Perfil ---------------- #
def perfil(inicio):
    # Verificación SOLO aquí
    if sesion["usuario"] == "hector" and sesion["contraseña"] == "2008":
        ventana_perfil=tk.Toplevel()
        ventana_perfil.title("Perfil - Jefe")
        ventana_perfil.geometry("500x500")
        tk.Label(ventana_perfil,text="Perfil del Jefe").pack(pady=10)
    elif sesion["usuario"] == "cbtisfs1001" and sesion["contraseña"] == "010909":
        ventana_perfil=tk.Toplevel()
        ventana_perfil.title("Perfil - Proveedor")
        ventana_perfil.geometry("500x500")
        tk.Label(ventana_perfil,text="Perfil del Proveedor").pack(pady=10)
    elif sesion["usuario"] == "nataly" and sesion["contraseña"] == "2009":
        ventana_perfil=tk.Toplevel()
        ventana_perfil.title("Perfil - Empleada")
        ventana_perfil.geometry("500x500")
        tk.Label(ventana_perfil,text="Perfil de Empleada").pack(pady=10)
    elif sesion["usuario"] == "ibrahim" and sesion["contraseña"] == "2009":
        ventana_perfil=tk.Toplevel()
        ventana_perfil.title("Perfil - Usuario Final")
        ventana_perfil.geometry("500x500")
        tk.Label(ventana_perfil,text="Perfil de Usuario Final").pack(pady=10)
    else:
        messagebox.showwarning("Acceso denegado", "Debes iniciar sesión con usuario y contraseña válidos")

# ---------------- Jefe ---------------- #
def Arbir_jefe(inicio):
    menu = tk.Toplevel(inicio)
    menu.title("Panel Principal - Guitarras Puebla")
    menu.geometry("400x400")
    tk.Label(menu, text="Bienvenido al panel principal", font=("Arial", 14)).pack(pady=20) 

# ---------------- Proveedor ---------------- #
def Abrir_Proovedor(inicio):
    style = ttk.Style()
    style.theme_use("default")

    ventana_proveedor = tk.Toplevel()
    ventana_proveedor.title("Proveedor")
    ventana_proveedor.geometry("1000x700")

    menu_abierto = False
    menu_frame = tk.Frame(ventana_proveedor, width=150, height=1000, bg="#00ccff")
    menu_frame.place(x=-150, y=0)

    btn_menu = tk.Button(ventana_proveedor, text="≡", font=("Times New Roman", 12, "bold"),
                         background="#FFFFFF", foreground="#245861")
    btn_menu.place(x=10, y=10)

    def animar_abrir(x_actual):
        if x_actual < 0:
            x_actual += 10
            menu_frame.place(x=x_actual, y=0)
            inicio.after(10, lambda: animar_abrir(x_actual))
        else:
            menu_frame.place(x=0, y=0)

    def animar_cerrar(x_actual):
        if x_actual > -150:
            x_actual -= 10
            menu_frame.place(x=x_actual, y=0)
            inicio.after(10, lambda: animar_cerrar(x_actual))
        else:
            menu_frame.place(x=-150, y=0)

    def abrir_menu():
        nonlocal menu_abierto
        if not menu_abierto:
            menu_abierto = True
            btn_menu.place_forget()
            animar_abrir(-150)

    def cerrar_menu():
        nonlocal menu_abierto
        if menu_abierto:
            menu_abierto = False
            animar_cerrar(0)
            btn_menu.place(x=10, y=10)

    btn_cerrar = tk.Button(menu_frame, text="X", font=("Arial", 14), bg="white", command=cerrar_menu)
    btn_cerrar.place(x=110, y=10)
    def cerrar_sesion(inicio):
        ventana_proveedor.destroy()
    def ver_perfil(inicio):
        ver=tk.Toplevel()
        ver.title(f"Perfil Proveedor")
        ver.geometry("600x300")
        def cerrar_pefil(inicio):
            ver.destroy()
        btn_cerrar=tk.Button(ver,text="Volver",command=lambda:cerrar_pefil(ventana_proveedor))
        btn_cerrar.place(x=15)
    tk.Button(menu_frame, text="Cerrar Sesión", command=lambda: cerrar_sesion(inicio)).place(x=20, y=60)
    tk.Button(menu_frame, text="Contactos", command=lambda: contactos(inicio)).place(x=20, y=100)
    tk.Button(menu_frame, text="Perfil", command=lambda: ver_perfil(inicio)).place(x=20, y=140)
    btn_menu.config(command=abrir_menu)

    tk.Button(ventana_proveedor, text="Regresar", command=lambda: regresar_inicio(inicio, ventana_proveedor)).pack(pady=10, padx=10)

    style.map("TNotebook.Tab", background=[("selected", "#402CF3")], foreground=[("selected", "#FF0000")])

    style.map("TNotebook.Tab", background=[("selected", "#402CF3")], foreground=[("selected", "#FF0000")])

    notebook = ttk.Notebook(ventana_proveedor)
    notebook.pack(padx=10, pady=10, fill='both', expand=True)

    frame1 = ttk.Frame(notebook, padding="10")
    frame_carrusel = ttk.Frame(notebook, padding="10")
    frame3 = ttk.Frame(notebook, padding="10")
# z
    notebook.add(frame1, text="Mensajes de pedidos")
    notebook.add(frame_carrusel, text="Carrusel")
    notebook.add(frame3, text="Pedidos entregados y cancelados")

    tk.Label(frame1, text="Mensajes").pack(pady=15)
    lista = tk.Listbox(frame1, font=("Arial", 14), width=50, fg="#00715A", bg="#FFFFFF")
    lista.pack(pady=10)
    for i in range(1, 7):
        lista.insert(i, f"Mensaje {i}")

    # Lista de imágenes
    tk.Label(frame_carrusel, text="Carrusel de imágenes").pack(pady=20)
    imagenes = [
        "trabajo_final\clasicas.jpg",
        "trabajo_final\hacusticas1.png",
        "trabajo_final\electricas.jpg"
    ]
    indice = 0
    width, height = 250, 250

    def cargar_imagen(path):
        img = Image.open(path).resize((width, height))
        return ImageTk.PhotoImage(img)

    def mostrar_imagen(i):
        nonlocal indice
        foto_actual = cargar_imagen(imagenes[i])
        canvas.delete("slide")
        canvas.create_image(0, 0, anchor="nw", image=foto_actual, tags="slide")
        canvas.image = foto_actual

    def transicion_siguiente():
        nonlocal indice
        indice = (indice + 1) % len(imagenes)
        nueva = cargar_imagen(imagenes[indice])
        x = width
        def animar():
            canvas.delete("slide")
            canvas.create_image(nonlocal_x[0], 0, anchor="nw", image=nueva, tags="slide")
            canvas.image = nueva
            nonlocal_x[0] -= 20
            if nonlocal_x[0] >= 0:
                ventana_proveedor.after(30, animar)
            else:
                mostrar_imagen(indice)
        nonlocal_x = [x]
        animar()
    def transicion_anterior():
        nonlocal indice
        indice = (indice - 1) % len(imagenes)
        nueva = cargar_imagen(imagenes[indice])
        x = -width
        def animar():
            canvas.delete("slide")
            canvas.create_image(nonlocal_x[0], 0, anchor="nw", image=nueva, tags="slide")
            canvas.image = nueva
            nonlocal_x[0] += 20
            if nonlocal_x[0] <= 0:
                ventana_proveedor.after(30, animar)
            else:
                mostrar_imagen(indice)
        nonlocal_x = [x]
        animar()
    canvas = tk.Canvas(frame_carrusel, width=width, height=height)
    canvas.pack()

    btn_prev = tk.Button(frame_carrusel, text="⏮️ Anterior", command=transicion_anterior)
    btn_prev.pack(side="left", padx=10)

    btn_next = tk.Button(frame_carrusel, text="⏭️ Siguiente", command=transicion_siguiente)
    btn_next.pack(side="right", padx=10)
    mostrar_imagen(indice)

    tk.Label(frame3, text="Noches").pack(pady=20)
    
    # foonter
    tk.Label(ventana_proveedor, text="© Derechos Reservados - Guitarras Puebla",
             bg="#dac9ad", font=("Arial", 10), fg="black").pack(side="bottom", fill="x")

    menu_frame.lift()
    btn_menu.lift()
# ---------------- Main ---------------- #
def main():
    inicio = tk.Tk()
    inicio.title("Menú Hamburguesa Animado")
    inicio.geometry("1000x700")

    # Header
    header = tk.Frame(inicio, bg="#775516", height=80)
    header.pack(fill="x")
    tk.Label(header, text="Mi Página Web", font=("Arial", 24, "bold"),
             fg="white", bg="#756542").place(relx=0.5, rely=0.5, anchor="center")

    # Logo
    imagen = Image.open("trabajo_final/logo_oficial.jpeg")
    imagen_pil = imagen.resize((60,60))
    imagen_tk = ImageTk.PhotoImage(imagen_pil)
    tk.Label(inicio, image=imagen_tk).place(x=130,y=10)
    inicio.imagen_tk = imagen_tk

    # Menú hamburguesa
    menu_abierto = False
    menu_frame = tk.Frame(inicio, width=150, height=1000, bg="#00ccff")
    menu_frame.place(x=-150, y=0)

    btn_menu = tk.Button(inicio, text="≡", font=("Times New Roman", 28, "bold"),
                         background="#FFFFFF", foreground="#245861")
    btn_menu.place(x=10, y=10)

    def animar_abrir(x_actual):
        if x_actual < 0:
            x_actual += 10
            menu_frame.place(x=x_actual, y=0)
            inicio.after(10, lambda: animar_abrir(x_actual))
        else:
            menu_frame.place(x=0, y=0)

    def animar_cerrar(x_actual):
        if x_actual > -150:
            x_actual -= 10
            menu_frame.place(x=x_actual, y=0)
            inicio.after(10, lambda: animar_cerrar(x_actual))
        else:
            menu_frame.place(x=-150, y=0)

    def abrir_menu():
        nonlocal menu_abierto
        if not menu_abierto:
            menu_abierto = True
            btn_menu.place_forget()
            animar_abrir(-150)

    def cerrar_menu():
        nonlocal menu_abierto
        if menu_abierto:
            menu_abierto = False
            animar_cerrar(0)
            btn_menu.place(x=10, y=10)

    btn_cerrar = tk.Button(menu_frame, text="X", font=("Arial", 14), bg="white", command=cerrar_menu)
    btn_cerrar.place(x=110, y=10)

    tk.Button(menu_frame, text="Login", command=lambda: login(inicio)).place(x=20, y=60)
    tk.Button(menu_frame, text="Contactos", command=lambda: contactos(inicio)).place(x=20, y=100)
    tk.Button(menu_frame, text="Perfil", command=lambda: perfil(inicio)).place(x=20, y=140)

    btn_menu.config(command=abrir_menu)
    inicio.mainloop()

if __name__ == "__main__":
    main()
